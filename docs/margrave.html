<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html><head><meta http-equiv="content-type" content="text-html; charset=utf-8" /><title>The Margrave Tool for Policy Analysis</title><link rel="stylesheet" type="text/css" href="scribble.css" title="default" /><link rel="stylesheet" type="text/css" href="racket.css" title="default" /><link rel="stylesheet" type="text/css" href="scribble-style.css" title="default" /><script type="text/javascript" src="scribble-common.js"></script></head><body id="scribble-racket-lang-org"><div class="tocset"><div class="tocview"><div class="tocviewlist" style="margin-bottom: 1em;"><div class="tocviewtitle"><table cellspacing="0" cellpadding="0"><tr><td style="width: 1em;"><a href="javascript:void(0);" title="Expand/Collapse" class="tocviewtoggle" onclick="TocviewToggle(this,&quot;tocview_0&quot;);">&#9658;</a></td><td></td><td><a href="" class="tocviewselflink" pltdoc="x">The <span style="font-weight: bold">Margrave</span> Tool for Policy Analysis</a></td></tr></table></div><div class="tocviewsublistonly" style="display: none;" id="tocview_0"><table cellspacing="0" cellpadding="0"><tr><td align="right">1&nbsp;</td><td><a href="#(part._.Getting_.Started)" class="tocviewlink" pltdoc="x">Getting Started</a></td></tr><tr><td align="right">2&nbsp;</td><td><a href="#(part._.Margrave_s_.Query_and_.Command_.Language)" class="tocviewlink" pltdoc="x">Margrave&rsquo;s Query and Command Language</a></td></tr><tr><td align="right">3&nbsp;</td><td><a href="#(part._.Representing_.Policies)" class="tocviewlink" pltdoc="x">Representing Policies</a></td></tr><tr><td align="right"></td><td><a href="#(part._doc-bibliography)" class="tocviewlink" pltdoc="x">Bibliography</a></td></tr></table></div></div></div><div class="tocsub"><table class="tocsublist" cellspacing="0"><tr><td><span class="tocsublinknumber">1<tt>&nbsp;</tt></span><a href="#(part._.Getting_.Started)" class="tocsubseclink" pltdoc="x">Getting Started</a></td></tr><tr><td><span class="tocsublinknumber">1.1<tt>&nbsp;</tt></span><a href="#(part._install)" class="tocsubseclink" pltdoc="x">Installing Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.1.1<tt>&nbsp;</tt></span><a href="#(part._.Lite_.Margrave)" class="tocsubseclink" pltdoc="x">Lite Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.1.2<tt>&nbsp;</tt></span><a href="#(part._.Full_.Margrave)" class="tocsubseclink" pltdoc="x">Full Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.2<tt>&nbsp;</tt></span><a href="#(part._running-margrave)" class="tocsubseclink" pltdoc="x">Running Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.2.1<tt>&nbsp;</tt></span><a href="#(part._running-lite)" class="tocsubseclink" pltdoc="x">Running Lite Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.2.2<tt>&nbsp;</tt></span><a href="#(part._running-full)" class="tocsubseclink" pltdoc="x">Running Full Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.3<tt>&nbsp;</tt></span><a href="#(part._gs-ios)" class="tocsubseclink" pltdoc="x">IOS in Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.3.1<tt>&nbsp;</tt></span><a href="#(part._.Understanding_.I.O.S_.Scenarios)" class="tocsubseclink" pltdoc="x">Understanding IOS Scenarios</a></td></tr><tr><td><span class="tocsublinknumber">1.4<tt>&nbsp;</tt></span><a href="#(part._gs-existing)" class="tocsubseclink" pltdoc="x">General Policies in Margrave</a></td></tr><tr><td><span class="tocsublinknumber">1.4.1<tt>&nbsp;</tt></span><a href="#(part._.Example_.Queries)" class="tocsubseclink" pltdoc="x">Example Queries</a></td></tr><tr><td><span class="tocsublinknumber">1.5<tt>&nbsp;</tt></span><a href="#(part._gs-create)" class="tocsubseclink" pltdoc="x">Creating Your Own Policies</a></td></tr><tr><td><span class="tocsublinknumber">2<tt>&nbsp;</tt></span><a href="#(part._.Margrave_s_.Query_and_.Command_.Language)" class="tocsubseclink" pltdoc="x">Margrave&rsquo;s Query and Command Language</a></td></tr><tr><td><span class="tocsublinknumber">2.1<tt>&nbsp;</tt></span><a href="#(part._query-language)" class="tocsubseclink" pltdoc="x">The Query Sub-<wbr></wbr>Language</a></td></tr><tr><td><span class="tocsublinknumber">2.2<tt>&nbsp;</tt></span><a href="#(part._command-language)" class="tocsubseclink" pltdoc="x">The Command Sub-<wbr></wbr>Language</a></td></tr><tr><td><span class="tocsublinknumber">2.2.1<tt>&nbsp;</tt></span><a href="#(part._.Getting_the_.Results_of_.E.X.P.L.O.R.E_.Statements)" class="tocsubseclink" pltdoc="x">Getting the Results of EXPLORE Statements</a></td></tr><tr><td><span class="tocsublinknumber">2.2.2<tt>&nbsp;</tt></span><a href="#(part._.Renaming_.Prior_.Queries)" class="tocsubseclink" pltdoc="x">Renaming Prior Queries</a></td></tr><tr><td><span class="tocsublinknumber">2.2.3<tt>&nbsp;</tt></span><a href="#(part._.Getting_.I.N.F.O)" class="tocsubseclink" pltdoc="x">Getting INFO</a></td></tr><tr><td><span class="tocsublinknumber">3<tt>&nbsp;</tt></span><a href="#(part._.Representing_.Policies)" class="tocsubseclink" pltdoc="x">Representing Policies</a></td></tr><tr><td><span class="tocsublinknumber">3.1<tt>&nbsp;</tt></span><a href="#(part._policies)" class="tocsubseclink" pltdoc="x">Elements of a Policy</a></td></tr><tr><td><span class="tocsublinknumber">3.2<tt>&nbsp;</tt></span><a href="#(part._vocabularies)" class="tocsubseclink" pltdoc="x">Elements of a Vocabulary</a></td></tr><tr><td><span class="tocsublinknumber"></span><a href="#(part._doc-bibliography)" class="tocsubseclink" pltdoc="x">Bibliography</a></td></tr></table></div></div><div class="maincolumn"><div class="main"><div class="versionbox"><span class="versionNoNav">Version: 5.0.1</span></div><h2><a name="(part._.The_.Margrave_.Tool_for_.Policy_.Analysis)"></a>The <span style="font-weight: bold">Margrave</span> Tool for Policy Analysis</h2><p>Tim Nelson &lt;<a href="mailto:tn@cs.wpi.edu">tn@cs.wpi.edu</a>&gt;</p><table cellspacing="0"><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Getting_.Started)" class="toptoclink" pltdoc="x">1<span class="hspace">&nbsp;</span>Getting Started</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._install)" class="toclink" pltdoc="x">1.1<span class="hspace">&nbsp;</span>Installing Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Lite_.Margrave)" class="toclink" pltdoc="x">1.1.1<span class="hspace">&nbsp;</span>Lite Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Full_.Margrave)" class="toclink" pltdoc="x">1.1.2<span class="hspace">&nbsp;</span>Full Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._running-margrave)" class="toclink" pltdoc="x">1.2<span class="hspace">&nbsp;</span>Running Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._running-lite)" class="toclink" pltdoc="x">1.2.1<span class="hspace">&nbsp;</span>Running Lite Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._running-full)" class="toclink" pltdoc="x">1.2.2<span class="hspace">&nbsp;</span>Running Full Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._gs-ios)" class="toclink" pltdoc="x">1.3<span class="hspace">&nbsp;</span>IOS in Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Understanding_.I.O.S_.Scenarios)" class="toclink" pltdoc="x">1.3.1<span class="hspace">&nbsp;</span>Understanding IOS Scenarios</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._gs-existing)" class="toclink" pltdoc="x">1.4<span class="hspace">&nbsp;</span>General Policies in Margrave</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Example_.Queries)" class="toclink" pltdoc="x">1.4.1<span class="hspace">&nbsp;</span>Example Queries</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._gs-create)" class="toclink" pltdoc="x">1.5<span class="hspace">&nbsp;</span>Creating Your Own Policies</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Margrave_s_.Query_and_.Command_.Language)" class="toptoclink" pltdoc="x">2<span class="hspace">&nbsp;</span>Margrave&rsquo;s Query and Command Language</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._query-language)" class="toclink" pltdoc="x">2.1<span class="hspace">&nbsp;</span>The Query Sub-Language</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._command-language)" class="toclink" pltdoc="x">2.2<span class="hspace">&nbsp;</span>The Command Sub-Language</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Getting_the_.Results_of_.E.X.P.L.O.R.E_.Statements)" class="toclink" pltdoc="x">2.2.1<span class="hspace">&nbsp;</span>Getting the Results of EXPLORE Statements</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Renaming_.Prior_.Queries)" class="toclink" pltdoc="x">2.2.2<span class="hspace">&nbsp;</span>Renaming Prior Queries</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Getting_.I.N.F.O)" class="toclink" pltdoc="x">2.2.3<span class="hspace">&nbsp;</span>Getting INFO</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._.Representing_.Policies)" class="toptoclink" pltdoc="x">3<span class="hspace">&nbsp;</span>Representing Policies</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._policies)" class="toclink" pltdoc="x">3.1<span class="hspace">&nbsp;</span>Elements of a Policy</a></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._vocabularies)" class="toclink" pltdoc="x">3.2<span class="hspace">&nbsp;</span>Elements of a Vocabulary</a></p></td></tr><tr><td><p><span class="hspace"></span></p></td></tr><tr><td><p><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;</span><a href="#(part._doc-bibliography)" class="toptoclink" pltdoc="x">Bibliography</a></p></td></tr></table><h3>1<tt>&nbsp;</tt><a name="(part._.Getting_.Started)"></a>Getting Started</h3><p>Welcome to Margrave!</p><p>Margrave is a tool for analyzing access-control and configuration
policies. Margrave allows users to ask questions about the
behavior of their policies, such as "Can a student ever access
another student&rsquo;s grades?" or "Did my changes to this firewall allow
any unexpected new traffic?"</p><p>The following examples demonstrate how to get started using Margrave.
If you have not yet installed Margrave, see <a href="#(part._install)" pltdoc="x">Installing Margrave</a>.
To analyze your own IOS firewall configuration,
see <a href="#(part._gs-ios)" pltdoc="x">IOS in Margrave</a>. For non-IOS uses, see the overview in
<a href="#(part._gs-existing)" pltdoc="x">General Policies in Margrave</a> and the instructions for <a href="#(part._gs-create)" pltdoc="x">Creating Your Own Policies</a>
in Margrave&rsquo;s intermediate language.</p><p>Margrave is part of an ongoing research project. We appreciate your
feedback and suggestions (including feature requests). Send these
to tn@cs.wpi.edu.</p><h4>1.1<tt>&nbsp;</tt><a name="(part._install)"></a>Installing Margrave</h4><p>There are two versions of Margrave: lite and full. The lite
version allows commands and queries to be entered at a prompt. The full
version provides a GUI and better
support for writing programs involving Margrave queries, but requires
installing a host environment.</p><h5>1.1.1<tt>&nbsp;</tt><a name="(part._.Lite_.Margrave)"></a>Lite Margrave</h5><ul><li><p>Make sure that you have a recent version of Java installed.
Margrave requires Java 6 or later. You can download the latest
version of Java at</p><p><a href="http://www.java.com/en/download/"><span class="url">http://www.java.com/en/download/</span></a>.</p></li><li><p>Download the LITE Margrave distribution from</p><p><a href="http://www.margrave-tool.org/v3"><span class="url">http://www.margrave-tool.org/v3</span></a>.</p><p>This is available for both Windows (as a zip file) and
*nix (as a tar.gz file).</p></li><li><p>Extract the distribution archive to the location of your choice.</p></li><li><p>Set your MARGRAVE_HOME environment variable to the location of
the margrave-lite executable in the extracted distribution.</p></li></ul><p>Now that Margrave Lite is installed,
see <a href="#(part._running-lite)" pltdoc="x">Running Lite Margrave</a> for instructions on running it.</p><h5>1.1.2<tt>&nbsp;</tt><a name="(part._.Full_.Margrave)"></a>Full Margrave</h5><ul><li><p>Make sure that you have a recent version of Java installed.
Margrave requires Java 6 or later. You can download the latest
version of Java at</p><p><a href="http://www.java.com/en/download/"><span class="url">http://www.java.com/en/download/</span></a>.</p></li><li><p>Download and install Racket from</p><p><a href="http://racket-lang.org/download/"><span class="url">http://racket-lang.org/download/</span></a></p></li><li><p>Download the FULL Margrave distribution from</p><p><a href="http://www.margrave-tool.org/v3"><span class="url">http://www.margrave-tool.org/v3</span></a>.</p><p>This is available for both Windows (as a zip file) and
*nix (as a tar.gz file).</p></li><li><p>Extract the distribution archive to the location of your choice.</p></li><li><p>Set your MARGRAVE_HOME environment variable to the location of
margrave-full-main.rkt in the extracted distribution.</p></li></ul><p><span style="font-weight: bold">For Mac OSX users:</span></p><p>Environment variables set in your .bashrc
file will only affect your terminal environment, and thus
will only be visible to DrRacket if you run it from your terminal prompt.
Making MARGRAVE_HOME available globally requires altering your
~/.MacOSX/environment.plist file. For more information see
<a href="http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/EnvironmentVars.html"><span class="url">http://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPRuntimeConfig/Articles/EnvironmentVars.html</span></a>.</p><p>Now that Margrave is installed,
see <a href="#(part._running-full)" pltdoc="x">Running Full Margrave</a> for instructions on running it.</p><h4>1.2<tt>&nbsp;</tt><a name="(part._running-margrave)"></a>Running Margrave</h4><p>Both versions of Margrave run in the Racket programming environment.
Whichever version you use, you will either enter individual commands at the
prompt or execute scripts (multiple commands at once). The command prompt
accepts Racket commands (in Lisp terms, it is a
read-eval-print-loop, or REPL). For instance, entering:</p><p><span class="RktPn">(</span><span class="RktSym">display-response</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">mtext</span><span class="stt"> </span><span class="RktVal">"INFO"</span><span class="RktPn">)</span><span class="RktPn">)</span></p><p>will execute the <a href="#(tech._info)" class="techoutside" pltdoc="x"><span class="techinside">INFO</span></a> Margrave command, returning information about the
state of Margrave, including memory usage and other statistics. The
<font class="badlink"><span class="techoutside"><span class="techinside">mtext</span></span></font> function runs the command and the <font class="badlink"><span class="techoutside"><span class="techinside">display-response</span></span></font>
function prints human-readable results. All Margrave commands must be
wrapped this way.</p><p>Commands may use standard Racket functions as well. For instance,
the <span class="RktSym">build-path</span> function will construct a relative path:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">build-path</span><span class="hspace">&nbsp;</span><span class="RktSym">margrave-home-path</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"examples"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lite"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lite-ios-demo.rkt"</span><span class="RktPn">)</span></td></tr></table></p><p>Use the <span class="RktSym">margrave-home-path</span> identifier to refer to the directory given
in the MARGRAVE_HOME environment variable.</p><h5>1.2.1<tt>&nbsp;</tt><a name="(part._running-lite)"></a>Running Lite Margrave</h5><p>Execute the margrave-lite executable (margrave-lite.exe or ./margrave-lite,
depending on your OS). It will automatically detect where your Java
installation is located, and attempt to start the Margrave engine from
the directory you provided via the MARGRAVE_HOME environment variable.</p><p>To execute individual commands, enter them at the prompt.</p><p>To load and run a script in Margrave Lite, call the <span class="RktSym">run-lite</span> function
with the relative path of the script file.
For instance, to load the example IOS firewall script, enter this at the
REPL prompt:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">run-lite</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">build-path</span><span class="hspace">&nbsp;</span><span class="RktSym">margrave-home-path</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"examples"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lite"</span><span class="hspace">&nbsp;</span><span class="RktVal">"lite-ios-demo.rkt"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>To exit Lite Margrave, type <span class="RktPn">(</span><span class="RktSym">exit</span><span class="RktPn">)</span> at the command prompt. If
you close Lite Margrave via ctrl-C, the Java-based engine may be left
running.</p><p>To use Margrave on IOS configurations, go to <a href="#(part._gs-ios)" pltdoc="x">IOS in Margrave</a>.
To use Margrave on other kinds of policies, go to <a href="#(part._gs-existing)" pltdoc="x">General Policies in Margrave</a>.
Examples of both can be found in <span style="font-style: italic">&lt;MARGRAVE_HOME&gt;/examples/lite</span>.</p><h5>1.2.2<tt>&nbsp;</tt><a name="(part._running-full)"></a>Running Full Margrave</h5><p>The full version of Margrave runs in DrRacket, the graphical development
environment for Racket.</p><p>To execute individual commands, load the "margrave-full-main.rkt" file in DrRacket and click Run.
It will automatically detect where your Java installation is located. After clicking Run, the
bottom half of the screen will provide a REPL prompt similar to the lite version.</p><p>To run a Margrave script, load the script file in DrRacket and click the Run button.
The script will execute, and then a REPL prompt will appear at the bottom of the DrRacket window.
Do not attempt to use <span class="RktSym">run-lite</span> in the full version.</p><p>To use Margrave on IOS configurations, go to <a href="#(part._gs-ios)" pltdoc="x">IOS in Margrave</a>.
To use Margrave on other kinds of policies, go to <a href="#(part._gs-existing)" pltdoc="x">General Policies in Margrave</a>.
Examples of both can be found in <span style="font-style: italic">&lt;MARGRAVE_HOME&gt;/examples/full</span>.</p><p><span style="font-weight: bold">A Word of Caution</span></p><p>Margrave&rsquo;s scenario-finding engine must be started by
invoking <span class="RktPn">(</span><span class="RktSym">start-margrave-engine</span><span class="RktPn">)</span> before
any policies are loaded or Margrave commands are executed.
Running margrave-full-main.rkt will do this automatically. If you
are writing your own script, make sure that it calls
<span class="RktPn">(</span><span class="RktSym">start-margrave-engine</span><span class="RktPn">)</span>.</p><h4>1.3<tt>&nbsp;</tt><a name="(part._gs-ios)"></a>IOS in Margrave</h4><p>Margrave supports a core subset of the IOS language involving
standard and most extended ACLs, static NAT,
ACL-based and map-based dynamic NAT, static routing,
and policy-based routing. At the moment, our support for state is
limited to reflexive access-lists.</p><p>Whether you installed the lite or full version of Margrave,
the IOS commands are the same, and should be entered at your version&rsquo;s
command prompt.</p><p>To parse and load an IOS policy into Margrave, use:</p><p><span class="RktPn">(</span><span class="RktSym">parse-and-load-ios</span><span class="stt"> </span><span class="RktSym">config-file-name</span><span class="stt"> </span><span class="RktSym">config-file-path</span><span class="RktPn">)</span></p><p>where <span class="RktSym">config-file-name</span> is the file name of the configuration
saved as a text file and <span class="RktSym">config-file-path</span> is the directory
containing the configuration.</p><p>Margrave will produce several intermediate policy files (discussed in Section 4 of [<a href="#(cite._nbdfk10)" pltdoc="x">nbdfk10</a>]) in
<span class="RktSym">config-file-path</span> and, if the engine has been started,
load them.</p><p>For instance, if you have a configuration saved to a file config.txt in
the directory "C:\Margrave\IOS", you should invoke:</p><p><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">parse-and-load-ios</span><span class="hspace">&nbsp;</span><span class="RktVal">"config.txt"</span><span class="hspace">&nbsp;</span><span class="RktVal">"C:\\Margrave\\IOS"</span><span class="RktPn">)</span></div><div class="SIntrapara">or</div></p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">parse-and-load-ios</span><span class="hspace">&nbsp;</span><span class="RktVal">"config.txt"</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">build-path</span><span class="hspace">&nbsp;</span><span class="RktVal">"C:"</span><span class="hspace">&nbsp;</span><span class="RktVal">"Margrave"</span><span class="hspace">&nbsp;</span><span class="RktVal">"IOS"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>For detailed examples of running queries in IOS, see the "ios-demo" example
in <span style="font-style: italic">&lt;MARGRAVE_HOME&gt;/examples/full</span> or <span style="font-style: italic">&lt;MARGRAVE_HOME&gt;/examples/lite</span>
(depending on your version). If you would like to experiment with a small IOS
configuration, we suggest using
<span style="font-style: italic">&lt;MARGRAVE_HOME&gt;/examples/policies/ios-demo/initial/demo.txt</span>.</p><h5>1.3.1<tt>&nbsp;</tt><a name="(part._.Understanding_.I.O.S_.Scenarios)"></a>Understanding IOS Scenarios</h5><p>"SHOW" commands format query results and display them
in a concise format. A SHOW ONE command for an IOS
query will produce output in this style:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">***</span><span class="hspace">&nbsp;</span><span class="RktSym">SOLUTION:</span><span class="hspace">&nbsp;</span><span class="RktSym">Size</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktVal">15.0</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">src-addr-in:</span><span class="hspace">&nbsp;</span><span class="RktSym">IPAddress</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">protocol:</span><span class="hspace">&nbsp;</span><span class="RktSym">prot-tcp</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">dest-addr-in:</span><span class="hspace">&nbsp;</span><span class="RktSym">192.168.5.10</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">src-port-in:</span><span class="hspace">&nbsp;</span><span class="RktSym">port</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">exit-interface:</span><span class="hspace">&nbsp;</span><span class="RktSym">interface</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">entry-interface:</span><span class="hspace">&nbsp;</span><span class="RktSym">fe0</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">dest-port-in:</span><span class="hspace">&nbsp;</span><span class="RktSym">port-80</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">length:</span><span class="hspace">&nbsp;</span><span class="RktSym">length</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">ahostname:</span><span class="hspace">&nbsp;</span><span class="RktSym">hostname-router</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">src-addr-out:</span><span class="hspace">&nbsp;</span><span class="RktSym">IPAddress</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">dest-addr-out:</span><span class="hspace">&nbsp;</span><span class="RktSym">192.168.5.10</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">message:</span><span class="hspace">&nbsp;</span><span class="RktSym">icmpmessage</span></td></tr></table></p><p>On the first line, the <span class="RktSym">Size</span><span class="stt"> </span><span class="RktSym">=</span><span class="stt"> </span><span class="RktVal">15</span> says that this scenario involves 15 atoms, where
each atom is an IP address, port, interface, etc.</p><p>The scenario itself says that the query can be satisfied by when the packet
is a TCP request to the host 192.168.5.10 on port 80, entering the firewall at the fe0 interface.
There are no restrictions on the source fields of the packet header in this
scenario: "IPAddress" represents some IP address not explicitly
mentioned in the IOS configuration. Similarly for "Port" and "Interface".</p><p>The <span style="font-style: italic">message</span> binding is only applicable for ICMP packets,
and can be ignored in this scenario. The <span style="font-style: italic">length</span> binding is not yet used.
The <span style="font-style: italic">-out</span> bindings give information about NAT effects on the packet; there
are none in this scenario.</p><p><div class="SIntrapara">When printing, only the most specific applicable
information will be shown. E.g., you will never see
</div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">src-addr-in:</span><span class="hspace">&nbsp;</span><span class="RktSym">10.0.0.0/255.0.0.0</span><span class="hspace">&nbsp;</span><span class="RktSym">10.100.100.100</span></div></p><p><div class="SIntrapara">since the host 10.100.100.100 is always contained in the network
10.0.0.0/255.0.0.0. Instead, you would see
</div><div class="SIntrapara"><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">src-addr-in:</span><span class="hspace">&nbsp;</span><span class="RktSym">10.100.100.100</span></div></p><h4>1.4<tt>&nbsp;</tt><a name="(part._gs-existing)"></a>General Policies in Margrave</h4><p>Margrave&rsquo;s intermediate
language can capture many different kinds of policies. In this section,
we discuss how to use the intermediate language to express policies for analysis.</p><p><span style="font-style: italic">What does a policy look like in Margrave?</span></p><p>A policy&rsquo;s form depends on its <a href="#(tech._vocabulary)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary</span></a>. A vocabulary dictates what
a <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> <font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font> is, what <a href="#(tech._decision)" class="techoutside" pltdoc="x"><span class="techinside">decision</span></a>s a policy renders,
and so on.</p><p>Let&rsquo;s examine one of Margrave&rsquo;s built-in examples,
an access-control policy for a conference management system. Its vocabulary and policy files
are respectively <span style="font-style: italic">conference1.v</span> and <span style="font-style: italic">conference1.p</span> in <span style="font-style: italic">&lt;MARGRAVE_HOME&gt;/tests</span>.</p><p>The vocabulary is:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PolicyVocab</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Types</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Subject</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Author</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Action</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitReview</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Resource</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">Review</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Decisions</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Permit</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Deny</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Predicates</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">ReqVariables</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">OthVariables</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Constraints</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">atmostone-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p><a href="#(part._vocabularies)" pltdoc="x">Elements of a Vocabulary</a> contains details about this language. For now, note that this particular vocabulary gives the following:</p><ul><li><p>A notion of "subjects", "actions", and "resources" and some sub-types for each;</p></li><li><p>"permit" and "deny" as valid decisions; and</p></li><li><p>a "subject", an "action", and a "resource" as part of each request (given by the ReqVariables construct).</p></li></ul><p>The policy for this example is:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy1</span><span class="hspace">&nbsp;</span><span class="RktSym">uses</span><span class="hspace">&nbsp;</span><span class="RktSym">conferencepolicy</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Target</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperNoConflict</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperAssigned</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperConflict</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Deny</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>This <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> <font class="badlink"><span class="techoutside"><span class="techinside">uses</span></span></font> the above vocabulary, and
contains three <a href="#(tech._rule)" class="techoutside" pltdoc="x"><span class="techinside">rules</span></a> that each map certain
<font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font>s to <a href="#(tech._decision)" class="techoutside" pltdoc="x"><span class="techinside">decision</span></a>s. For instance, the first rule,
named PaperNoConflict, causes the policy to permit requests to read
papers, provided the subject is not known to be conflicted on the
paper. (For details, see <a href="#(part._policies)" pltdoc="x">Elements of a Policy</a>.)</p><h5>1.4.1<tt>&nbsp;</tt><a name="(part._.Example_.Queries)"></a>Example Queries</h5><p>Margrave loads policies using the <span class="RktSym">load-policy</span> function.
<span class="RktSym">load-policy</span> takes a single parameter: the filename of the policy file.
Since this policy is stored in the tests subfolder of Margrave, we load it by
calling:</p><p><span class="RktPn">(</span><span class="RktSym">load-policy</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">build-path</span><span class="stt"> </span><span class="RktSym">margrave-home-path</span><span class="stt"> </span><span class="RktVal">"tests"</span><span class="stt"> </span><span class="RktVal">"conference1.p"</span><span class="RktPn">)</span><span class="RktPn">)</span></p><p>If the policy loads successfully, <span class="RktSym">load-policy</span> returns the policy&rsquo;s identifier for use in queries. In this case, it returns:</p><p><span class="RktVal">"ConferencePolicy"</span></p><p>Let&rsquo;s ask Margrave whether a reviewer can ever be denied access to read a paper.
The following Margrave query captures this question.</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">display-response</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mtext</span><span class="hspace">&nbsp;</span><span class="RktVal">"EXPLORE ConferencePolicy:Deny(s, a, r) AND "</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktVal">"reviewer(s) AND paper(r) AND readpaper(a)"</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p><div class="SIntrapara"><span style="font-style: italic">reviewer(s)</span>, <span style="font-style: italic">paper(r)</span> and <span style="font-style: italic">readpaper(a)</span>
signify properties about the request: The subject is a reviewer,
etc. The term
<span style="font-style: italic">ConferencePolicy:Deny(s, a, r)</span> states that the policy
renders the "Deny" decision for the request. </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Rendering deny is
not the same as failing to render permit!</p></blockquote></blockquote></blockquote></div><div class="SIntrapara">The <span class="RktSym">EXPLORE</span> statement as a whole instructs Margrave to find
scenarios that meet all of those conditions.</div></p><p>(For more information on Margrave&rsquo;s query language, see <a href="#(part._query-language)" pltdoc="x">The Query Sub-Language</a>.)</p><p>Once the query is created,
we can ask for <span style="font-style: italic">all</span> scenarios that satisfy the query with:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mtext</span><span class="hspace">&nbsp;</span><span class="RktVal">"SHOW ALL"</span><span class="RktPn">)</span><span class="RktPn">)</span></p><p>whereas</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">printf</span><span class="hspace">&nbsp;</span><span class="RktVal">"~a~n"</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">mtext</span><span class="hspace">&nbsp;</span><span class="RktVal">"SHOW ONE"</span><span class="RktPn">)</span><span class="RktPn">)</span></p><p>shows only the first scenario found.</p><p>One of the solutions will be this one:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">***</span><span class="hspace">&nbsp;</span><span class="RktSym">SOLUTION:</span><span class="hspace">&nbsp;</span><span class="RktSym">Size</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktVal">3.0</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">$s:</span><span class="hspace">&nbsp;</span><span class="RktSym">reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">author</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">$r:</span><span class="hspace">&nbsp;</span><span class="RktSym">paper</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">$a:</span><span class="hspace">&nbsp;</span><span class="RktSym">readpaper</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktPn">[</span><span class="RktSym">$s</span><span class="RktRdr">,</span><span class="RktSym">$r</span><span class="RktPn">]</span><span class="RktPn">}</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktSym">assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">{</span><span class="RktPn">}</span></td></tr></table></p><p>The block above represents a scenario where the query could be
satisfied. "SHOW" commands format query results and display them
in this concise format. The scenario above says:
"The query can be satisfied when the Subject is
both a Reviewer and an Author, the Resource is a Paper, and
the action is reading the paper, provided that
the subject is Conflicted on the Paper but not Assigned to it."</p><p>Here, $s, $a, and $r correspond to the variables that appear in
the query.
Size = 3 means that in this scenario, there were 3 objects.
In this case, one is BOTH a Reviewer and an
Author, another is a Paper, and the third is the action ReadPaper.</p><p>Conflicted and Assigned are
binary <a href="#(tech._predicate)" class="techoutside" pltdoc="x"><span class="techinside">predicates</span></a> mentioned in the policy. Any such facts
will be printed after information about individual variables.</p><p>Note: When printing, only the most specific applicable
information will be shown. E.g., you will never see
<span style="font-style: italic">$s: reviewer subject</span>
because a reviewer is always a subject.</p><h4>1.5<tt>&nbsp;</tt><a name="(part._gs-create)"></a>Creating Your Own Policies</h4><p>You can create your own policies in the same style as the examples above. <a href="#(part._policies)" pltdoc="x">Elements of a Policy</a> and <a href="#(part._vocabularies)" pltdoc="x">Elements of a Vocabulary</a> contain more details on the policy language. Place the vocabulary in a text-file with the .v extension, and the policy in a text-file with the .p extension. Make sure that you refer to the correct vocabulary name in the policy file. For instance, if your vocabulary is in the file myvocab.v, make sure that the vocabulary is named <span style="font-style: italic">myvocab</span> and the policy <span style="font-style: italic">uses myvocab</span>.</p><h3>2<tt>&nbsp;</tt><a name="(part._.Margrave_s_.Query_and_.Command_.Language)"></a>Margrave&rsquo;s Query and Command Language</h3><h4>2.1<tt>&nbsp;</tt><a name="(part._query-language)"></a>The Query Sub-Language</h4><p>Margrave&rsquo;s query language contains only one statement: <a name="(tech._explore)"></a><span style="font-style: italic">EXPLORE</span>. Explore statements instruct Margrave to look for scenarios that satisfy the statement&rsquo;s conditions. For instance,</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">EXPLORE</span><span class="hspace">&nbsp;</span><span class="RktSym">administrator</span><span class="RktPn">(</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">OR</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">CEO</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">AND</span><span class="hspace">&nbsp;</span><span class="RktSym">supervisor</span><span class="RktPn">(</span><span class="RktSym">y</span><span class="RktRdr">,</span><span class="RktSym">x</span><span class="RktPn">)</span><span class="RktPn">)</span></p><p>tells Margrave to look for scenarios where <span style="font-style: italic">x</span> is either an administrator or supervised directly by a CEO. When querying a policy, first use an EXPLORE statement to define the scenarios of interest, and then a SHOW or GET command (<a href="#(part._command-language)" pltdoc="x">The Command Sub-Language</a>) to get the results.</p><p><a href="#(tech._explore)" class="techoutside" pltdoc="x"><span class="techinside">EXPLORE</span></a> statements have the following form:</p><p><a href="#(tech._explore)" class="techoutside" pltdoc="x"><span class="techinside">EXPLORE</span></a> &lt;condition&gt; <br />
[<a href="#(tech._under)" class="techoutside" pltdoc="x"><span class="techinside">UNDER</span></a> &lt;policy-name&gt;, ...] <br />
[<a href="#(tech._publish)" class="techoutside" pltdoc="x"><span class="techinside">PUBLISH</span></a> &lt;variable-name&gt;, ...] <br />
[<a href="#(tech._tupling)" class="techoutside" pltdoc="x"><span class="techinside">TUPLING</span></a>] <br />
[<a href="#(tech._include)" class="techoutside" pltdoc="x"><span class="techinside">INCLUDE</span></a> &lt;id&gt;, ...] <br />
[<a href="#(tech._ceiling)" class="techoutside" pltdoc="x"><span class="techinside">CEILING</span></a> &lt;number&gt;] <br /></p><p>Clauses enclosed in [] are optional, and can appear in any order.</p><p>A <a name="(tech._vocabulary._predicate)"></a><span style="font-style: italic">vocabulary predicate</span> is the name of either a <a href="#(tech._type)" class="techoutside" pltdoc="x"><span class="techinside">type</span></a> or
<font class="badlink"><span class="techoutside"><span class="techinside">other predicate</span></span></font> in the query&rsquo;s <a href="#(tech._vocabulary._context)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary context</span></a>.
Every <a href="#(tech._vocabulary._predicate)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary predicate</span></a> has an arity no less than 1.
If a <a href="#(tech._vocabulary._predicate)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary predicate</span></a> is the name of a <a href="#(tech._type)" class="techoutside" pltdoc="x"><span class="techinside">type</span></a>,
its arity is 1, and it is called a <a name="(tech._unary)"></a><span style="font-style: italic">unary</span> predicate.</p><p>A &lt;condition&gt; is a boolean combination (via AND, OR, IFF, IMPLIES, NOT, and parentheses) of <a href="#(tech._atomic._formula)" class="techoutside" pltdoc="x"><span class="techinside">atomic formula</span></a>s.</p><p>An <a name="(tech._atomic._formula)"></a><span style="font-style: italic">atomic formula</span> is one of:</p><ul><li><p><div class="SIntrapara">an <a name="(tech._atomic._vocabulary._formula)"></a><span style="font-style: italic">atomic vocabulary formula</span>, which is one of:
</div><div class="SIntrapara"><ul><li><p><span style="font-weight: bold">predname(x<span style="vertical-align: sub; font-size: 80%">1</span>, ..., x<span style="vertical-align: sub; font-size: 80%">k</span>)</span>,
 where x<span style="vertical-align: sub; font-size: 80%">1</span>, ..., x<span style="vertical-align: sub; font-size: 80%">k</span> are (not necessarily distinct) variable symbols
 and &lt;predname&gt; is a <a href="#(tech._vocabulary._predicate)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary predicate</span></a> of arity k;</p></li><li><p><span style="font-weight: bold">x IN predname</span>, where x is a variable symbol and
 &lt;predname&gt; is a unary <a href="#(tech._vocabulary._predicate)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary predicate</span></a>;</p></li><li><p><span style="font-weight: bold">(x<span style="vertical-align: sub; font-size: 80%">1</span>, ..., x<span style="vertical-align: sub; font-size: 80%">k</span>) IN predname</span>,
 where x<span style="vertical-align: sub; font-size: 80%">1</span>, ..., x<span style="vertical-align: sub; font-size: 80%">k</span> are (not necessarily distinct) variable symbols
 and &lt;predname&gt; is a k-ary <a href="#(tech._vocabulary._predicate)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary predicate</span></a>;</p></li><li><p><span style="font-weight: bold">x = typename</span>, where x is a variable symbol and
 &lt;typename&gt; is the name of an <a href="#(tech._at._most._one)" class="techoutside" pltdoc="x"><span class="techinside">at-most-one</span></a>
 or <a href="#(tech._singleton)" class="techoutside" pltdoc="x"><span class="techinside">singleton</span></a> constrained type in the
 statement&rsquo;s <a href="#(tech._vocabulary._context)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary context</span></a></p></li></ul></div></p></li><li><p><div class="SIntrapara">an <a name="(tech._atomic._idb._formula)"></a><span style="font-style: italic">atomic IDB formula</span>, which is one of:
</div><div class="SIntrapara"><ul><li><p><span style="font-weight: bold">policyid:idbname(x<span style="vertical-align: sub; font-size: 80%">1</span>, ..., x<span style="vertical-align: sub; font-size: 80%">k</span>)</span>, where policyid is an identifier
for a <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> with a k-ary <font class="badlink"><span class="techoutside"><span class="techinside">request vector</span></span></font>, idbname is a valid <a href="#(tech._idb)" class="techoutside" pltdoc="x"><span class="techinside">IDB</span></a>
in that policy),
and x<span style="vertical-align: sub; font-size: 80%">1</span>,...,x<span style="vertical-align: sub; font-size: 80%">k</span> are (not necessarily distinct) variable symbols;</p></li><li><p><span style="font-weight: bold">savedquery(x<span style="vertical-align: sub; font-size: 80%">1</span>, ..., x<span style="vertical-align: sub; font-size: 80%">k</span>)</span>, where savedquery is an identifier for a
k-ary saved query, and x<span style="vertical-align: sub; font-size: 80%">1</span>, ..., x<span style="vertical-align: sub; font-size: 80%">k</span> are (not necessarily distinct) variable symbols</p></li></ul></div></p></li><li><p>or a <a name="(tech._variable._equality._formula)"></a><span style="font-style: italic">variable equality formula</span>: <span style="font-weight: bold">x = y</span>, where x and y are variable symbols.</p></li></ul><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>The saved query identifier <span style="font-weight: bold">last</span> always refers to the last successful EXPLORE statement.</p></blockquote></blockquote></blockquote><p>Every EXPLORE statement has a <a name="(tech._vocabulary._context)"></a><span style="font-style: italic">vocabulary context</span>: the set of
vocabularies across all policies mentioned in the query&rsquo;s &lt;condition&gt;
and its UNDER clause, if any. If the policies have incompatable vocabularies
(for example, if they both define the same predicate name, but with a
different arity) the query will return an error.</p><p>The term <a name="(tech._idb)"></a><span style="font-style: italic">IDB</span> is taken from the database field.
Each policy provides a set of <a href="#(tech._idb)" class="techoutside" pltdoc="x"><span class="techinside">IDB</span></a>s that represent
policy decisions, rule applicability, and more.
For details, see Section 2 of [<a href="#(cite._nbdfk10)" pltdoc="x">nbdfk10</a>].</p><p>The <a name="(tech._under)"></a><span style="font-style: italic">UNDER</span> clause adds policies to the query&rsquo;s <a href="#(tech._vocabulary._context)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary context</span></a> that do not appear in the query &lt;condition&gt;.
If the &lt;condition&gt; does not explicitly refer to a policy, the query must include an UNDER clause.</p><p>The <a name="(tech._publish)"></a><span style="font-style: italic">PUBLISH</span> clause dictates which variables in the query condition are published for use in later queries.</p><p>The <a name="(tech._tupling)"></a><span style="font-style: italic">TUPLING</span> clause activates the optional tupling optimization. In order to qualify for tupling,
all of the query&rsquo;s saved-query predicates (if any) must refer to saved queries that <a href="#(tech._publish)" class="techoutside" pltdoc="x"><span class="techinside">PUBLISH</span></a>ed all of their variables.</p><p>The syntax of the <a name="(tech._include)"></a><span style="font-style: italic">INCLUDE</span> clause differs depending on whether tupling has been enabled.</p><ul><li><p>If <a href="#(tech._tupling)" class="techoutside" pltdoc="x"><span class="techinside">TUPLING</span></a> is not enabled, then the <a href="#(tech._include)" class="techoutside" pltdoc="x"><span class="techinside">INCLUDE</span></a> clause contains a nonempty list of
   policy <a href="#(tech._idb)" class="techoutside" pltdoc="x"><span class="techinside">IDB</span></a> predicates whose instantiations are to be included in the scenario
   output.</p><p><span style="font-weight: bold">Example:</span>
   <span style="font-style: italic">INCLUDE mypolicy:permit</span> will cause each output scenario to include the requests that <span style="font-style: italic">mypolicy</span> permits.</p></li><li><p>If <a href="#(tech._tupling)" class="techoutside" pltdoc="x"><span class="techinside">TUPLING</span></a> is enabled, then the <a href="#(tech._include)" class="techoutside" pltdoc="x"><span class="techinside">INCLUDE</span></a> clause may contain a nonempty list of IDB
   and/or <a href="#(tech._vocabulary._predicate)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary predicate</span></a>s; however a tuple of
   arguments must be supplied to each predicate.
   Variable names shared between <a href="#(tech._include)" class="techoutside" pltdoc="x"><span class="techinside">INCLUDE</span></a> and
   the &lt;condition&gt; are assumed to refer to the same variable.</p><p><span style="font-weight: bold">Examples:</span>
   <span style="font-style: italic">INCLUDE mypolicy:permit(r, a, s)</span> causes each scenario to report if the request (r, a, s) is permitted by mypol.</p><p><span style="font-style: italic">INCLUDE mypolicy:permit(s, a, r), mypolicy:permit(r, a, s)</span> sets the watch on both (s, a, r) and (r, a, s). </p></li></ul><p>The <a name="(tech._ceiling)"></a><span style="font-style: italic">CEILING</span> clause provides a limit on the scenario-sizes Margrave will check. In most cases, Margrave can infer its own sufficient ceiling (see the Margrave firewall paper [<a href="#(cite._nbdfk10)" pltdoc="x">nbdfk10</a>]). If not, Margrave uses the user-provided ceiling (or <span style="font-style: italic">6</span>, if none is provided).</p><h4>2.2<tt>&nbsp;</tt><a name="(part._command-language)"></a>The Command Sub-Language</h4><p>The rest of Margrave&rsquo;s language consists of commands.</p><h5>2.2.1<tt>&nbsp;</tt><a name="(part._.Getting_the_.Results_of_.E.X.P.L.O.R.E_.Statements)"></a>Getting the Results of EXPLORE Statements</h5><p>If you just want to know if any scenarios exist to satisfy a query, follow it up with the IS POSSIBLE? command.</p><p>To get concrete scenarios, use:</p><p><div class="SIntrapara"><a name="(tech._show._all)"></a><span style="font-style: italic">SHOW ALL</span>: Returns a string containing <span style="font-style: italic">all</span> satisfying scenarios, pretty-printed for Human consumption. </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Beware casual use of the SHOW ALL and GET ALL commands, as some queries can have enormous numbers of satisfying scenarios.</p></blockquote></blockquote></blockquote></div></p><p><a name="(tech._show._one)"></a><span style="font-style: italic">SHOW ONE</span>: Returns a string containing <span style="font-style: italic">the first</span> satisfying scenario that Margrave finds, pretty-printed for Human consumption.</p><p><div class="SIntrapara"><a name="(tech._show._next)"></a><span style="font-style: italic">SHOW NEXT</span>: Returns a string containing <span style="font-style: italic">the next</span> satisfying scenario. Use in concert with SHOW ONE. </div><div class="SIntrapara"><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>Without a preceding SHOW ONE, the first SHOW NEXT will behave like SHOW ONE.</p></blockquote></blockquote></blockquote></div></p><p><a name="(tech._get._one)"></a><span style="font-style: italic">GET ONE</span>, <a name="(tech._get._next)"></a><span style="font-style: italic">GET NEXT</span>, <a name="(tech._get._all)"></a><span style="font-style: italic">GET ALL</span>: Same as SHOW, except returns an XML object that represents the scenario and can be used in programs.</p><p>If the <a href="#(tech._tupling)" class="techoutside" pltdoc="x"><span class="techinside">TUPLING</span></a> optimization is enabled, the following commands also become available:</p><p><a name="(tech._show._(un)realized._~3catom~3e,._......)"></a><span style="font-style: italic">SHOW (UN)REALIZED &lt;atom&gt;, ...</span>: Given a list ("candidates") of
<a href="#(tech._atomic._idb._formula)" class="techoutside" pltdoc="x"><span class="techinside">atomic IDB formula</span></a>s, <font class="badlink"><span class="techoutside"><span class="techinside">atomic predicate formula</span></span></font>s, and
<font class="badlink"><span class="techoutside"><span class="techinside">atomic type formula</span></span></font>s,
returns a list of all atomic formualas given that can be true in a satisfying scenario.</p><p><a name="(tech._show._(un)realized._~3catom~3e,._......._for._cases._~3catom~3e,._......)"></a><span style="font-style: italic">SHOW (UN)REALIZED &lt;atom&gt;, ... FOR CASES &lt;atom&gt;, ...</span>:
Given two lists ("candidates" and "cases") of <a href="#(tech._atomic._idb._formula)" class="techoutside" pltdoc="x"><span class="techinside">atomic IDB formula</span></a>s,
<font class="badlink"><span class="techoutside"><span class="techinside">atomic predicate formula</span></span></font>s, and <font class="badlink"><span class="techoutside"><span class="techinside">atomic type formula</span></span></font>s,
returns a map taking each case to a separate <font class="badlink"><span class="techoutside"><span class="techinside">SHOW (UN)REALIZED</span></span></font> list
where the case was included in the &lt;condition&gt;.</p><p>The example files contain sample uses of each of these. SHOW REALIZED is especially useful when reasoning about interactions between rules.</p><h5>2.2.2<tt>&nbsp;</tt><a name="(part._.Renaming_.Prior_.Queries)"></a>Renaming Prior Queries</h5><p>To rename a query or policy, use the <a name="(tech._rename)"></a><span style="font-style: italic">RENAME</span> command:</p><p><span style="font-style: italic"><a href="#(tech._rename)" class="techoutside" pltdoc="x"><span class="techinside">RENAME</span></a> old-identifier new-identifier</span></p><p>For example, suppose you want to compare two different versions of the same policy, which have the same name by default. You can load the first version, then</p><p><span style="font-style: italic">RENAME policy policy_orig</span></p><p>then load the new version and</p><p><span style="font-style: italic">RENAME policy policy_new</span></p><p>Now you can write a single query that refers to both policies, such as this partial change-impact query:</p><p><span style="font-style: italic">EXPLORE policy_old:deny(x) AND policy_new:permit(x)</span></p><h5>2.2.3<tt>&nbsp;</tt><a name="(part._.Getting_.I.N.F.O)"></a>Getting INFO</h5><p>To get general information about the Margrave engine, including memory use and other statistics, use the <a name="(tech._info)"></a><span style="font-style: italic">INFO</span> command:</p><p><span style="font-style: italic"><a href="#(tech._info)" class="techoutside" pltdoc="x"><span class="techinside">INFO</span></a></span></p><p>To get information about a specific policy, vocabulary, or saved query, append the policy, vocabulary, or query identifier:</p><p><span style="font-style: italic"><a href="#(tech._info)" class="techoutside" pltdoc="x"><span class="techinside">INFO</span></a> mypolicy</span></p><h3>3<tt>&nbsp;</tt><a name="(part._.Representing_.Policies)"></a>Representing Policies</h3><p>Policies map <font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font>s to <a href="#(tech._decision)" class="techoutside" pltdoc="x"><span class="techinside">decision</span></a>s. Each <font class="badlink"><span class="techoutside"><span class="techinside">policy</span></span></font> is associated with exactly one <a href="#(tech._vocabulary)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary</span></a>.
In this section, we demonstrate the elements of policies and vocabularies using the conference policy presented in <a href="#(part._gs-existing)" pltdoc="x">General Policies in Margrave</a>.</p><blockquote class="refpara"><blockquote class="refcolumn"><blockquote class="refcontent"><p>We are in the process of making the vocabulary and policy languages more intuitive, and new documentation will be forthcoming.</p></blockquote></blockquote></blockquote><h4>3.1<tt>&nbsp;</tt><a name="(part._policies)"></a>Elements of a Policy</h4><p><span style="font-weight: bold">The Example Policy</span></p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy1</span><span class="hspace">&nbsp;</span><span class="RktSym">uses</span><span class="hspace">&nbsp;</span><span class="RktSym">conferencepolicy</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Target</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperNoConflict</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperAssigned</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperConflict</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Deny</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PComb</span><span class="hspace">&nbsp;</span><span class="RktSym">FAC</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><ul><li><p><span class="RktSym">ConferencePolicy1</span> is the <a name="(tech._policy._name)"></a><span style="font-style: italic">policy name</span>.
 Use the policy name to reference the policy in Margrave queries.</p></li><li><p><span class="RktSym">conferencepolicy</span> is the policy&rsquo;s <a name="(tech._vocabulary._name)"></a><span style="font-style: italic">vocabulary name</span>.
 Every policy has a single <a href="#(tech._vocabulary)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary</span></a> that dictates what a
 <font class="badlink"><span class="techoutside"><span class="techinside">request</span></span></font> is and which <a href="#(tech._decision)" class="techoutside" pltdoc="x"><span class="techinside">decisions</span></a> the policy renders. </p></li><li><p><span class="RktPn">(</span><span class="RktSym">Target</span><span class="RktPn">)</span> is the policy&rsquo;s <a name="(tech._target)"></a><span style="font-style: italic">target</span>. The <a href="#(tech._target)" class="techoutside" pltdoc="x"><span class="techinside">target</span></a>
 specifies a guard on the policy&rsquo;s applicability. In order for any rule
 in the policy to apply, the policy&rsquo;s <a href="#(tech._target)" class="techoutside" pltdoc="x"><span class="techinside">target</span></a> condition must also
 apply. For instance, <span class="RktPn">(</span><span class="RktSym">Target</span><span class="stt"> </span><span class="RktPn">(</span><span class="RktSym">Reviewer</span><span class="stt"> </span><span class="RktSym">s</span><span class="RktPn">)</span><span class="RktPn">)</span> would mean that the
 policy applies only to subjects who are reviewers.</p><p>An empty <a href="#(tech._target)" class="techoutside" pltdoc="x"><span class="techinside">target</span></a>, as shown above, means that
 the policy can always apply.</p></li><li><p>The <span class="RktPn">(</span><span class="RktSym">Rules</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> construct gives the policy&rsquo;s <a name="(tech._rule)"></a><span style="font-style: italic">rule</span> set.
    Each <a href="#(tech._rule)" class="techoutside" pltdoc="x"><span class="techinside">rule</span></a> has a name, a decision, and a set of <a name="(tech._condition)"></a><span style="font-style: italic">conditions</span>.
    Each <a href="#(tech._condition)" class="techoutside" pltdoc="x"><span class="techinside">condition</span></a> must be the use of a <a href="#(tech._type)" class="techoutside" pltdoc="x"><span class="techinside">type</span></a> or <a href="#(tech._predicate)" class="techoutside" pltdoc="x"><span class="techinside">predicate</span></a>
    in the policy&rsquo;s vocabulary. A "!" before a <a href="#(tech._type)" class="techoutside" pltdoc="x"><span class="techinside">type</span></a> or <a href="#(tech._predicate)" class="techoutside" pltdoc="x"><span class="techinside">predicate</span></a>
    name means that the type or predicate does <span style="font-style: italic">not</span> apply.</p><p>The first rule in the example policy:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PaperNoConflict</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">!Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="RktPn">)</span></p><p>is named <span class="RktSym">PaperNoConflict</span>, renders the <span class="RktSym">Permit</span> decision, and applies when
    the subject is trying to read a paper on which he or she is not conflicted.</p><p>The variable names that appear after the decision name (e.g. <span class="RktSym">Permit</span><span class="stt"> </span><span class="RktSym">s</span><span class="stt"> </span><span class="RktSym">a</span><span class="stt"> </span><span class="RktSym">r</span>) must exactly match
    the names of the request variables declared in the policy&rsquo;s <a href="#(tech._vocabulary)" class="techoutside" pltdoc="x"><span class="techinside">vocabulary</span></a>. New variables can
    be introduced on the right hand side of the rule, in which case they are interpreted
    existentially. E.g., this rule would apply for any subject who owns <span style="font-style: italic">some</span> car,
    regardless of the action and resource involved:</p><p><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PermitIfOwnsCar</span><span class="hspace">&nbsp;</span><span class="RktSym">=</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Permit</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">r</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktSym">:-</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Owns</span><span class="hspace">&nbsp;</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Car</span><span class="hspace">&nbsp;</span><span class="RktSym">c</span><span class="RktPn">)</span><span class="RktPn">)</span></p></li><li><p><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> denotes the policy&rsquo;s
 <a name="(tech._rule._combination._algorithm)"></a><span style="font-style: italic">rule-combination algorithm</span>. This is used to resolve rule conflicts.
 Margrave currently supports <a href="#(tech._first._applicable)" class="techoutside" pltdoc="x"><span class="techinside">first-applicable</span></a>, <a href="#(tech._override)" class="techoutside" pltdoc="x"><span class="techinside">overrides</span></a>,
 and <a href="#(tech._none)" class="techoutside" pltdoc="x"><span class="techinside">none</span></a> combinators:</p><ul><li><p><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="stt"> </span><span class="RktSym">FAC</span><span class="RktPn">)</span>: In <a name="(tech._first._applicable)"></a><span style="font-style: italic">first-applicable</span> policies, rules apply in
   the order in which they appear.</p></li><li><p><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="stt"> </span><span class="RktSym">O</span><span class="stt"> </span><span class="RktSym">&lt;decisions&gt;</span><span class="RktPn">)</span>: In <a name="(tech._override)"></a><span style="font-style: italic">overrides</span> policies,
 the vocabulary gives an
 ordering on the decisions, and higher-priority decisions
 take precedence over lower-priority decisions. E.g.,
 <span class="RktPn">(</span><span class="RktSym">RComb</span><span class="stt"> </span><span class="RktSym">O</span><span class="stt"> </span><span class="RktSym">CallPolice</span><span class="stt"> </span><span class="RktSym">Deny</span><span class="stt"> </span><span class="RktSym">Permit</span><span class="RktPn">)</span> means that the
 CallPolice decision overrides the Deny and Permit decisions,
 and the Deny decision overrides the Permit decision.</p></li><li><p><span class="RktPn">(</span><span class="RktSym">RComb</span><span class="stt"> </span><span class="RktSym">none</span><span class="RktPn">)</span>: In <a name="(tech._none)"></a><span style="font-style: italic">none</span> policies, multiple rules (indeed, multiple
   decisions) can apply to a single request.</p></li></ul></li><li><p>Margrave also supports hierarchical policies via <span class="RktPn">(</span><span class="RktSym">Children</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span>: A policy&rsquo;s <a name="(tech._children)"></a><span style="font-style: italic">children</span> are a list
 of sub-policies that together form the parent policy. A policy
 contains either <a href="#(tech._rule)" class="techoutside" pltdoc="x"><span class="techinside">rules</span></a> (in which case it is a
 <a name="(tech._leaf._policy)"></a><span style="font-style: italic">leaf policy</span>) or <a href="#(tech._children)" class="techoutside" pltdoc="x"><span class="techinside">children</span></a> but never both. For example:</p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">Parentpolicy</span><span class="hspace">&nbsp;</span><span class="RktSym">uses</span><span class="hspace">&nbsp;</span><span class="RktSym">myvocab</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktSym">...</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">Child1</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Policy</span><span class="hspace">&nbsp;</span><span class="RktSym">Child2</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Rules</span><span class="hspace">&nbsp;</span><span class="RktSym">...</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Children</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>Conflicts between sub-policies are resolved via a <a name="(tech._policy._combination._algorithm)"></a><span style="font-style: italic">policy-combination algorithm</span>, which is set
 with the <span class="RktPn">(</span><span class="RktSym">PComb</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> construct. The same options are available to policy combination as to
 rule combination.</p></li></ul><h4>3.2<tt>&nbsp;</tt><a name="(part._vocabularies)"></a>Elements of a Vocabulary</h4><p><span style="font-weight: bold">The Example Vocabulary</span></p><p><table cellspacing="0" class="RktBlk"><tr><td><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">PolicyVocab</span><span class="hspace">&nbsp;</span><span class="RktSym">ConferencePolicy</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Types</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Subject</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Author</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Action</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">ReadPaper</span><span class="hspace">&nbsp;</span><span class="RktSym">SubmitReview</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Resource</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="hspace">&nbsp;</span><span class="RktSym">Review</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Decisions</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Permit</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktSym">Deny</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Predicates</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Conflicted</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">Assigned</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Reviewer</span><span class="hspace">&nbsp;</span><span class="RktSym">Paper</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">ReqVariables</span><span class="hspace">&nbsp;</span><span class="RktPn">(</span><span class="RktSym">s</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">a</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">r</span><span class="hspace">&nbsp;</span><span class="RktSym">:</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">OthVariables</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="RktPn">(</span><span class="RktSym">Constraints</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">disjoint-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">atmostone-all</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Action</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">abstract</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Subject</span><span class="RktPn">)</span></td></tr><tr><td><span class="RktPlain"><span class="hspace">&nbsp;&nbsp;</span></span><span class="hspace">&nbsp;&nbsp;</span><span class="RktPn">(</span><span class="RktSym">nonempty</span><span class="hspace">&nbsp;</span><span class="RktSym">Resource</span><span class="RktPn">)</span><span class="RktPn">)</span><span class="RktPn">)</span></td></tr></table></p><p>A policy for a door lock may take keys as requests, and decide whether or not the door opens.
A phone company policy may take source and destination phone numbers and decide whether the call is denied, toll-free, or toll.
Margrave allows users to specify these domain-specific details about a policy using <a href="#(tech._vocabulary)" class="techoutside" pltdoc="x"><span class="techinside">vocabularies</span></a>.</p><p>A <a name="(tech._vocabulary)"></a><span style="font-style: italic">vocabulary</span> in Margrave contains the following:</p><ul><li><p>The <span class="RktPn">(</span><span class="RktSym">Types</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> construct defines a hierarchy of
    <a name="(tech._type)"></a><span style="font-style: italic">type</span>s (also called <a name="(tech._sort)"></a><span style="font-style: italic">sort</span>s) that
    elements of a request may belong to.</p><p>Top-level types (Subject, Action, and Resource in the above example)
    are always pairwise <a href="#(tech._disjoint)" class="techoutside" pltdoc="x"><span class="techinside">disjoint</span></a>.</p></li><li><p>The <span class="RktPn">(</span><span class="RktSym">Predicates</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> construct defines a set of
    <a name="(tech._predicate)"></a><span style="font-style: italic">predicate</span>s that may hold of request
    properties in a scenario. For instance, the binary <a href="#(tech._predicate)" class="techoutside" pltdoc="x"><span class="techinside">predicate</span></a> Assigned from
    <a href="#(part._gs-existing)" pltdoc="x">General Policies in Margrave</a> contains reviewer-to-paper assignments in a
    given scenario.</p></li><li><p>The <span class="RktPn">(</span><span class="RktSym">Decisions</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> construct gives a set of <a name="(tech._decision)"></a><span style="font-style: italic">Decisions</span>
    that policies using this vocabulary render. The standard examples are
    permit and deny, but others can appear in more detailed policies.</p></li><li><p>The <span class="RktPn">(</span><span class="RktSym">ReqVariables</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> construct defines the shape of a request
    in this vocabulary. The request variables are an ordered list of variable
    names and a type assignment for each.
    For instance, in the access-control domain, the request variables will
    often be (subj, act, res). In the firewall domain, the request variables
    will involve IP addresses, ports, etc.</p></li><li><p>The <span class="RktPn">(</span><span class="RktSym">Constraints</span><span class="stt"> </span><span class="RktSym">...</span><span class="RktPn">)</span> construct gives domain-specific assertions
                     about how types and predicates can be populated. Margrave will not consider
                     scenarios that violate vocabulary constraints, ruling out non-sensical results.</p><p>Valid <a name="(tech._constraint)"></a><span style="font-style: italic">constraint</span> types are:</p><ul><li><p><span style="font-weight: bold">At-most-one</span>: If a type is <a name="(tech._at._most._one)"></a><span style="font-style: italic">at-most-one</span> constrained, it can never contain more than one thing.</p></li><li><p><span style="font-weight: bold">Singleton</span>: If a type is <a name="(tech._singleton)"></a><span style="font-style: italic">singleton</span> constrained, it must contain exactly one thing.</p></li><li><p><span style="font-weight: bold">Nonempty</span>: A <a name="(tech._nonempty)"></a><span style="font-style: italic">nonempty</span> type must never be empty.</p></li><li><p><span style="font-weight: bold">Abstract</span>: An <a name="(tech._abstract)"></a><span style="font-style: italic">abstract</span> type is fully covered by its children.
 For instance, consider a type Bit with child types ZeroBit and OneBit.
 If Bit is abstract, every Bit must be either a zero or a one. </p></li><li><p><span style="font-weight: bold">Function</span>: A binary predicate P: (A x B) can be constrained to behave as a total or partial function from A to B.</p></li><li><p><span style="font-weight: bold">Disjoint</span>: Two types that are <a name="(tech._disjoint)"></a><span style="font-style: italic">disjoint</span> must never share an atom.</p></li><li><p><span style="font-weight: bold">Subset</span>: Used to enforce subset constraints that cannot be captured in the type hierarchy.
 If type A is constrained to be a <a name="(tech._subset)"></a><span style="font-style: italic">subset</span> of B, every scenario
 will have A contained in B, even if B is not a super-type of A.</p></li></ul><p>The constraints <a href="#(tech._disjoint)" class="techoutside" pltdoc="x"><span class="techinside">Disjoint</span></a>, <a href="#(tech._at._most._one)" class="techoutside" pltdoc="x"><span class="techinside">at-most-one</span></a>, <a href="#(tech._singleton)" class="techoutside" pltdoc="x"><span class="techinside">singleton</span></a>, and <a href="#(tech._nonempty)" class="techoutside" pltdoc="x"><span class="techinside">nonempty</span></a>
can be applied to <span style="font-style: italic">all</span> subtypes of a type at once by using the <span class="RktSym">-all</span> suffix.</p></li></ul><h3><a name="(part._doc-bibliography)"></a>Bibliography</h3><p><table cellspacing="0" class="RBibliography"><tr><td><a name="(cite._nbdfk10)"></a>[nbdfk10]</td><td><span class="hspace">&nbsp;</span></td><td><span class="bibentry">Timothy Nelson and Christopher Barratt and Daniel J. Dougherty and Kathi Fisler and Shriram Krishnamurthi, &ldquo;The Margrave Tool for Firewall Analysis,&rdquo; Proceedings of the 24th USENIX Large Installation System Administration Conference (LISA 2010), 2010. <a href="http://web.cs.wpi.edu/~tn/Publications/lisa10-margrave-final.pdf"><span class="stt">http://web.cs.wpi.edu/~tn/Publications/lisa10-margrave-final.pdf</span></a></span></td></tr></table></p></div></div><div id="contextindicator">&nbsp;</div></body></html>